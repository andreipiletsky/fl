(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{"0v18":function(e,l,t){"use strict";t.r(l);var n=t("CcnG"),a=function(){return function(){}}(),i=t("pMnS"),o=t("ZBxj"),u=t("G/xV"),d=t("VSng"),r=t("Ip0R"),s=n["ɵcrt"]({encapsulation:2,styles:[],data:{}});function p(e){return n["ɵvid"](0,[(e()(),n["ɵeld"](0,0,null,null,3,"span",[],null,null,null,null,null)),n["ɵprd"](512,null,r["ɵNgClassImpl"],r["ɵNgClassR2Impl"],[n.IterableDiffers,n.KeyValueDiffers,n.ElementRef,n.Renderer2]),n["ɵdid"](2,278528,null,0,r.NgClass,[r["ɵNgClassImpl"]],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n["ɵpod"](3,{"ui-clickable":0,"ui-button-icon-left":1,"ui-button-icon-right":2})],(function(e,l){var t=l.component,n=t.icon,a=e(l,3,0,!0,"left"===t.iconPos,"right"===t.iconPos);e(l,2,0,n,a)}),null)}function c(e){return n["ɵvid"](0,[(e()(),n["ɵeld"](0,0,null,null,10,"button",[],[[1,"type",0],[8,"disabled",0]],[[null,"click"],[null,"focus"],[null,"blur"]],(function(e,l,t){var n=!0,a=e.component;return"click"===l&&(n=!1!==a.onClick.emit(t)&&n),"focus"===l&&(n=!1!==a.onFocus.emit(t)&&n),"blur"===l&&(n=!1!==a.onBlur.emit(t)&&n),n}),null,null)),n["ɵprd"](512,null,r["ɵNgClassImpl"],r["ɵNgClassR2Impl"],[n.IterableDiffers,n.KeyValueDiffers,n.ElementRef,n.Renderer2]),n["ɵdid"](2,278528,null,0,r.NgClass,[r["ɵNgClassImpl"]],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n["ɵpod"](3,{"ui-button ui-widget ui-state-default ui-corner-all":0,"ui-button-icon-only":1,"ui-button-text-icon-left":2,"ui-button-text-icon-right":3,"ui-button-text-only":4,"ui-button-text-empty":5,"ui-state-disabled":6}),n["ɵprd"](512,null,r["ɵNgStyleImpl"],r["ɵNgStyleR2Impl"],[n.ElementRef,n.KeyValueDiffers,n.Renderer2]),n["ɵdid"](5,278528,null,0,r.NgStyle,[r["ɵNgStyleImpl"]],{ngStyle:[0,"ngStyle"]},null),n["ɵncd"](null,0),(e()(),n["ɵand"](16777216,null,null,1,null,p)),n["ɵdid"](8,16384,null,0,r.NgIf,[n.ViewContainerRef,n.TemplateRef],{ngIf:[0,"ngIf"]},null),(e()(),n["ɵeld"](9,0,null,null,1,"span",[["class","ui-button-text ui-clickable"]],null,null,null,null,null)),(e()(),n["ɵted"](10,null,["",""]))],(function(e,l){var t=l.component,n=t.styleClass,a=e(l,3,0,!0,t.icon&&!t.label,t.icon&&t.label&&"left"===t.iconPos,t.icon&&t.label&&"right"===t.iconPos,!t.icon&&t.label,!t.icon&&!t.label,t.disabled);e(l,2,0,n,a),e(l,5,0,t.style),e(l,8,0,t.icon)}),(function(e,l){var t=l.component;e(l,0,0,t.type,t.disabled),e(l,10,0,t.label||"ui-btn")}))}var m=t("eFDZ"),f=t("NCbS"),g=t("HA+t"),h=t("mrSG"),b=t("6h/C"),S=t("W4q/"),y=t("F5IH"),w=t("klSw"),M=t("67Y/"),v=function(){function e(e){this.serverService=e}return e.prototype.getSppElements=function(e){return this.sppElements$?e():this.sppElements$=this.serverService.get("ru-RU/spp",e).pipe(Object(w.a)(1),Object(M.a)((function(e){return(e||[]).map((function(e){return Object(h.__assign)({},e,{Id:e.SppId,MinTransactionDate:e.MinTransactionDate?new Date(e.MinTransactionDate):null,MaxTransactionDate:e.MaxTransactionDate?new Date(e.MaxTransactionDate):null,DateExcludeFromNzs:e.DateExcludeFromNzs?new Date(e.DateExcludeFromNzs):null,dn7Type:e.dn7Type,dn7SubType:e.dn7SubType,SmbLocalityId:e.SmbLocalityId})}))}))),this.sppElements$},e.prototype.updateSppElements=function(e,l){return e.forEach((function(e){e.Well?(e.SmbWellId=e.Well.Id,e.LocalityName=e.Well.LocalityName):e.SmbWellId=null})),this.serverService.post("ru-RU/spp",l,e)},e.prototype.getDnSevenList=function(e){return this.serverService.get("spp/dn7",e)},e.prototype.getColumnConfig=function(e,l,t){var n=l.map((function(e){return{label:e,value:e}})),a=e.map((function(e){return{label:e,value:e}})),i=(new Date).getFullYear();return[new b.a({field:"DzoName",header:"ДО",filterType:S.a.Multiselect}),new b.a({field:"Id",header:"Код",filterType:S.a.Text}),new b.a({field:"SppName",header:"Название",filterType:S.a.Text}),new b.a({field:"TotalAmmount",header:"Сумма, руб.",filterType:S.a.Text}),new b.a({field:"MinTransactionDate",header:"Минимальная дата",filterType:S.a.Date,type:"date",minMaxRange:[2006,i]}),new b.a({field:"MaxTransactionDate",header:"Максимальная дата",filterType:S.a.Date,type:"date",minMaxRange:[2006,i]}),new b.a({field:"DateExcludeFromNzs",header:"Дата НЗС",filterType:S.a.Date,type:"date",minMaxRange:[2006,i],edit:!0}),new b.a({field:"NotCostSpp",header:"Исключить",filterType:S.a.Multiselect,type:"checkbox",edit:!0}),new b.a({field:"Dn7SubTypeName",header:"ДН - 7",filterType:S.a.Multiselect,type:"dropdown",edit:!0,dropdownOptions:a}),new b.a({field:"DesignSolution",header:"Проектные решения",edit:!0,filterType:S.a.Text}),new b.a({field:"LocalityName",header:"Месторождение",filterType:S.a.Multiselect,type:"dropdown",edit:!0,dropdownOptions:n}),new b.a({field:"Well",header:"Скважина",filterType:S.a.Text,type:"modal",edit:!0,tableData:{columns:[new b.a({field:"LocalityName",header:"Месторождение"}),new b.a({field:"WellName",header:"Скважина"}),new b.a({field:"ProfileType",header:"Тип"})],data:t,dataKey:"Id"}}),new b.a({field:"SmbDn7WellTypeName",header:"Тип",filterType:S.a.Multiselect})]},e.ngInjectableDef=n["ɵɵdefineInjectable"]({factory:function(){return new e(n["ɵɵinject"](y.a))},token:e,providedIn:"root"}),e}(),C=t("wGtS"),D=t("909l"),T=t("Uc9X"),_=function(){function e(e,l,t,n){this.sppElementService=e,this.wellsService=l,this.toastService=t,this.tableService=n,this.canSave=!1,this.updatedSppElements=[],this.colGroup=[{text:"СПП - элемент",colspan:"10"},{text:"СМБ",colspan:"3"}]}return e.prototype.onEditData=function(e){e&&-1===this.updatedSppElements.map((function(e){return e.Id})).indexOf(e.Id)&&(this.updatedSppElements.push(e),this.canSave=!0)},e.prototype.onSelectedRowChange=function(e){var l=e.value,t=e.row,n=this.sppElements.findIndex((function(e){return e.Id===t.Id})),a=this.sppElements[n];a&&(l?(a.LocalityName=l.LocalityName,a.WellName=l.WellName,a.Well=l,a.SmbDn7WellTypeName=l.ProfileType):(delete a.LocalityName,delete a.WellName,delete a.Well,delete a.SmbDn7WellTypeName))},e.prototype.updateSppElements=function(){var e=this;this.isLoading=!0,this.sppElementService.updateSppElements(this.updatedSppElements,(function(){return e.isLoading=!1})).subscribe((function(){e.toastService.showSuccess("СПП элементы успешно сохранены!")}))},e.prototype.ngOnInit=function(){var e=this;this.isLoading=!0,Object(D.a)(this.sppElementService.getSppElements((function(){e.isLoading=!1,setTimeout((function(){return e.getHeightDifference()}),100)})),this.wellsService.getSppWell((function(){})),this.wellsService.getLocalities((function(){})),this.sppElementService.getDnSevenList((function(){}))).subscribe((function(l){var t=l[1],n=l[2],a=l[3];e.sppElements=l[0].map((function(e){return Object(h.__assign)({},e,{Well:e.SmbWellId?t.find((function(l){return l.Id===e.SmbWellId})):null})})),e.colsSpp=e.sppElementService.getColumnConfig(a,n,t)}))},e.prototype.getHeightDifference=function(){this.sppElements&&this.calcTableHeight()},e.prototype.calcTableHeight=function(){this.tableHeight=this.tableService.getElementsHeight([".header",".ui-table-caption",".ui-table-scrollable-header",".table__colspan",".ui-paginator"],"40px")},e}(),N=n["ɵcrt"]({encapsulation:0,styles:[[".spp__button-save{margin-bottom:10px}  .spp__table td.ng-star-inserted .ui-dropdown{min-width:auto;width:100%}  ui-button.ui-widget.ui-state-default.ui-corner-all.ui-button-text-only{margin-bottom:10px}  td.ng-star-inserted,   th.ng-star-inserted{word-break:break-all}  .ui-calendar .ui-datepicker{width:200%}[_nghost-%COMP%]  .table__borderless-cell.ui-editable-column.ng-star-inserted.ui-editing-cell{padding:.571em .857em}[_nghost-%COMP%]  td.ng-star-inserted, [_nghost-%COMP%]  th.ng-star-inserted{width:200px}[_nghost-%COMP%]  .ui-datepicker-calendar td, [_nghost-%COMP%]  .ui-datepicker-calendar th{width:100%}[_nghost-%COMP%]  .table__colspan:first-child{width:2000px}[_nghost-%COMP%]  .table__colspan:last-child{width:600px}"]],data:{}});function x(e){return n["ɵvid"](0,[(e()(),n["ɵeld"](0,0,null,null,7,"div",[["class","spp"]],null,null,null,null,null)),(e()(),n["ɵeld"](1,0,null,null,1,"app-loader",[],null,null,null,o.b,o.a)),n["ɵdid"](2,49152,null,0,u.a,[],{isLoading:[0,"isLoading"]},null),(e()(),n["ɵeld"](3,0,null,null,1,"p-button",[["class","spp__button-save"],["iconPos","right"],["label","Сохранить"]],null,[[null,"click"]],(function(e,l,t){var n=!0;return"click"===l&&(n=!1!==e.component.updateSppElements()&&n),n}),c,s)),n["ɵdid"](4,49152,null,0,d.Button,[],{iconPos:[0,"iconPos"],label:[1,"label"],disabled:[2,"disabled"]},null),(e()(),n["ɵeld"](5,0,null,null,2,"app-table",[["class","spp__table"]],null,[[null,"editData"],[null,"selectedRowChange"],["window","resize"]],(function(e,l,t){var a=!0,i=e.component;return"window:resize"===l&&(a=!1!==n["ɵnov"](e,6).onTotalCountChange()&&a),"editData"===l&&(a=!1!==i.onEditData(t)&&a),"selectedRowChange"===l&&(a=!1!==i.onSelectedRowChange(t)&&a),a}),m.b,m.a)),n["ɵdid"](6,638976,null,0,f.a,[g.a],{data:[0,"data"],cols:[1,"cols"],paginator:[2,"paginator"],rowsPerPageOptions:[3,"rowsPerPageOptions"],hasGlobalSearch:[4,"hasGlobalSearch"],dataKey:[5,"dataKey"],colGroup:[6,"colGroup"],tableHeight:[7,"tableHeight"]},{selectedRowChange:"selectedRowChange",editData:"editData"}),n["ɵpad"](7,3)],(function(e,l){var t=l.component;e(l,2,0,t.isLoading),e(l,4,0,"right","Сохранить",!t.canSave);var n=t.sppElements,a=t.colsSpp,i=e(l,7,0,10,25,50);e(l,6,0,n,a,!0,i,!0,"Id",t.colGroup,t.tableHeight)}),null)}function I(e){return n["ɵvid"](0,[(e()(),n["ɵeld"](0,0,null,null,1,"app-spp-base",[],null,[["window","resize"]],(function(e,l,t){var a=!0;return"window:resize"===l&&(a=!1!==n["ɵnov"](e,1).getHeightDifference(t)&&a),a}),x,N)),n["ɵdid"](1,114688,null,0,_,[v,C.a,T.a,g.a],null,null)],(function(e,l){e(l,1,0)}),null)}var E=n["ɵccf"]("app-spp-base",_,I,{},{},[]),k=t("gIcY"),L=t("t/Na"),P=t("ZYCi"),R=function(){return function(){}}(),O=t("7LN8"),W=t("Fzqc"),F=t("dWZg"),z=t("qAlS"),H=t("g4HV"),j=t("nciF"),G=t("mU/a"),K=t("Czxz"),V=t("No4M"),B=t("Fa87"),q=t("KB/w"),A=t("K8Pq"),U=t("T+K8"),Y=t("HQi4"),Z=t("rmC/"),X=t("EjV3"),$=t("66nc"),J=t("FpXt"),Q=t("a8Xb");t.d(l,"SppElementsModuleNgFactory",(function(){return ee}));var ee=n["ɵcmf"](a,[],(function(e){return n["ɵmod"]([n["ɵmpd"](512,n.ComponentFactoryResolver,n["ɵCodegenComponentFactoryResolver"],[[8,[i.a,E]],[3,n.ComponentFactoryResolver],n.NgModuleRef]),n["ɵmpd"](4608,r.NgLocalization,r.NgLocaleLocalization,[n.LOCALE_ID,[2,r["ɵangular_packages_common_common_a"]]]),n["ɵmpd"](4608,k["ɵangular_packages_forms_forms_o"],k["ɵangular_packages_forms_forms_o"],[]),n["ɵmpd"](4608,g.a,g.a,[]),n["ɵmpd"](4608,y.a,y.a,[L.c]),n["ɵmpd"](4608,v,v,[y.a]),n["ɵmpd"](4608,C.a,C.a,[y.a]),n["ɵmpd"](1073742336,r.CommonModule,r.CommonModule,[]),n["ɵmpd"](1073742336,P.n,P.n,[[2,P.s],[2,P.l]]),n["ɵmpd"](1073742336,R,R,[]),n["ɵmpd"](1073742336,O.SharedModule,O.SharedModule,[]),n["ɵmpd"](1073742336,W.a,W.a,[]),n["ɵmpd"](1073742336,F.b,F.b,[]),n["ɵmpd"](1073742336,z.ScrollingModule,z.ScrollingModule,[]),n["ɵmpd"](1073742336,H.TooltipModule,H.TooltipModule,[]),n["ɵmpd"](1073742336,j.DropdownModule,j.DropdownModule,[]),n["ɵmpd"](1073742336,k["ɵangular_packages_forms_forms_d"],k["ɵangular_packages_forms_forms_d"],[]),n["ɵmpd"](1073742336,k.FormsModule,k.FormsModule,[]),n["ɵmpd"](1073742336,G.PaginatorModule,G.PaginatorModule,[]),n["ɵmpd"](1073742336,K.TableModule,K.TableModule,[]),n["ɵmpd"](1073742336,V.MultiSelectModule,V.MultiSelectModule,[]),n["ɵmpd"](1073742336,B.InputTextModule,B.InputTextModule,[]),n["ɵmpd"](1073742336,d.ButtonModule,d.ButtonModule,[]),n["ɵmpd"](1073742336,q.CalendarModule,q.CalendarModule,[]),n["ɵmpd"](1073742336,A.SliderModule,A.SliderModule,[]),n["ɵmpd"](1073742336,U.CheckboxModule,U.CheckboxModule,[]),n["ɵmpd"](1073742336,Y.OverlayPanelModule,Y.OverlayPanelModule,[]),n["ɵmpd"](1073742336,Z.ListboxModule,Z.ListboxModule,[]),n["ɵmpd"](1073742336,X.ProgressSpinnerModule,X.ProgressSpinnerModule,[]),n["ɵmpd"](1073742336,$.DialogModule,$.DialogModule,[]),n["ɵmpd"](1073742336,J.a,J.a,[]),n["ɵmpd"](1073742336,Q.a,Q.a,[]),n["ɵmpd"](1073742336,a,a,[]),n["ɵmpd"](1024,P.j,(function(){return[[{path:"",component:_}]]}),[])])}))}}]);