<div class="well-container"> <div ng-hide="data.loaded" class="full-height text-primary"> <centered-fa-spinner></centered-fa-spinner> </div> <div ng-show="data.loaded" class="container-fluid top-padded locality-filters"> <div class="sub-heading"> <a class="choice" href="" ng-click="selectCompany(data.company)">{{data.company.name}}</a> <i class="fa fa-long-arrow-right"></i> <a class="choice" href="" ng-click="selectField(data.field)">{{data.field.name}}</a> <i class="fa fa-long-arrow-right"></i> <a class="choice" ng-click="selectWell()" ng-show="data.well.clusterName"><span style="float: none">Куст {{data.well.clusterName}}</span></a> <i class="fa fa-long-arrow-right" ng-show="data.well.clusterName"></i> <a class="no-choice">Скважина-{{data.well.name}}</a> <smb-double-view-switch style="float: right" show-excel="true" excel-handler="getExcel()" show-daily-cost="true" daily-cost-handler="openDailyCost()"></smb-double-view-switch> </div> <div ng-show="data.error" class="sub-content-container error-container"> <p class="error-message">Не удалось получить данные.</p> </div> <div class="sub-content-container"> <div class="row panel"> <div class="col-sm-12"> <h3 class="text-center">Основная информация</h3> <div class="col-sm-6"> <p><strong>Начало бурения:</strong> {{data.wellInfo.DrillBegin | date:'dd.MM.yyyy HH:mm'}}</p> <p><strong>Окончание бурения:</strong> {{data.wellInfo.DrillEnd | date:'dd.MM.yyyy HH:mm'}}</p> <p><strong>Начало освоения:</strong> {{data.wellInfo.ExplorationBegin | date:'dd.MM.yyyy'}}</p> <p><strong>Окончание освоения:</strong> {{data.wellInfo.ExplorationEnd | date:'dd.MM.yyyy'}}</p> <p><strong>Начало ВНР:</strong> {{data.wellInfo.VnrBegin | date:'dd.MM.yyyy'}}</p> <p><strong>Окончание ВНР:</strong> {{data.wellInfo.VnrEnd | date:'dd.MM.yyyy'}}</p> <p><strong>Дата сдачи:</strong> {{data.wellInfo.ExploitationBegin | date:'dd.MM.yyyy'}}</p> <p><strong>Буровая установка:</strong> {{data.wellInfo.DrillRig}}</p> <p><strong>Цель бурения:</strong> {{data.wellInfo.DrillType}}</p> <p><strong>Тип скважины:</strong> {{data.wellInfo.Dn7Type}}</p> <p><strong>Подтип скважины:</strong> {{data.wellInfo.Dn7SubType}}</p> <p><strong>Назначение:</strong> {{data.wellInfo.CategoryType}}</p> <p><strong>СПП-Элемент:</strong> <span ng-show="!canEditSppId()">{{data.wellInfo.SppId}}</span> <a ng-show="canEditSppId() && data.wellInfo.SppId" href="" ng-click="editSppId()">{{data.wellInfo.SppId}}</a> <a ng-show="canEditSppId() && !data.wellInfo.SppId" href="" ng-click="editSppId()">Изменить</a> <a ng-show="canEditSppId() && data.wellInfo.SppId" href="" ng-click="removeSppId()"><i class="fa fa-times text-danger"></i></a> </p> </div> <div class="col-sm-6"> <p ng-repeat="contractorType in data.wellInfo.Contractors"><strong>{{contractorType.LineName}}:</strong> <span ng-bind-html="getContractorsNames(contractorType.LineId, contractorType)"></span></p> </div> </div> </div> <div class="tab-container"> <uib-tabset justified="true"> <uib-tab heading="Физика"> <div class="row physic-tab"> <div class="col-sm-12"> <div class="has-no-value-container"> <div bs-tooltip="'Нет данных'" class="has-no-value" ng-repeat="param in data.physParamsEmpty">{{param}} (факт)</div> </div> <!--
                  data-param-name="{{param}}" фактически это значение используется для разработки и отладки.
                  Нужно, чтобы было проще получить внутренее наименование параметра, потому что на него завязана некоторая логика.
                --> <div class="col-sm-3" ng-repeat="param in data.physParams" ng-show="data.widgetsData[param]" data-param-name="{{param}}"> <smb-widget ng-model="data.widgetsData[param]" hide-difference="true" hide-plan="false"></smb-widget> </div> </div> </div> </uib-tab> <uib-tab heading="Экономика"> <div class="row econm-tab"> <div class="col-sm-12"> <div class="has-no-value-container"> <div bs-tooltip="'Нет данных'" class="has-no-value" ng-repeat="param in data.finParamsEmpty">{{param}} (факт)</div> </div> <!--
                  data-param-name="{{param}}" фактически это значение используется для разработки и отладки.
                  Нужно, чтобы было проще получить внутренее наименование параметра, потому что на него завязана некоторая логика.
                --> <div class="col-sm-3" ng-repeat="param in data.finParams" ng-show="data.widgetsData[param]" data-param-name="{{param}}"> <smb-widget ng-model="data.widgetsData[param]" hide-difference="true" hide-plan="false"></smb-widget> </div> </div> </div> </uib-tab> <uib-tab heading="Затраты"> <div class="table-container" ng-show="data.benchItems.benchItemsSrc && data.benchItems.benchItemsSrc.length"> <table class="filters-table"> <tbody> <tr> <td class="text-right" style="width: 120px"> Комплекс услуг: </td> <td class="text-left" style="width: 130px"> <button type="button" class="btn btn-sm btn-default btn-select" ng-model="data.benchItems.filters.setName" placeholder="Комплекс услуг" bs-options="set.id as set.name for set in data.benchItems.sets" bs-select> <span class="caret"></span> </button> </td> <td class="text-right" style="width: 70px"> Услуга: </td> <td class="text-left" style="width: 130px"> <button type="button" class="btn btn-sm btn-default btn-select" ng-model="data.benchItems.filters.subSetName" placeholder="Услуга" bs-options="subSet.id as subSet.name for subSet in data.benchItems.subSets" bs-select> <span class="caret"></span> </button> </td> <td class="text-right" style="width: 80px"> Договор: </td> <td class="text-left" style="width: 130px"> <button type="button" class="btn btn-sm btn-default btn-select" ng-model="data.benchItems.filters.contractId" placeholder="Договор" bs-options="contract.id as contract.name for contract in data.benchItems.contracts" bs-select> <span class="caret"></span> </button> </td> <td class="text-right" style="width: 100px"> Подрядчик: </td> <td class="text-left" style="width: 130px"> <button type="button" class="btn btn-sm btn-default btn-select" ng-model="data.benchItems.filters.contractorName" placeholder="Подрядчик" bs-options="contractor.id as contractor.name for contractor in data.benchItems.contractors" data-placement="bottom-right" bs-select> <span class="caret"></span> </button> </td> </tr> </tbody> </table> <table st-safe-src="data.benchItems.filteredBenchItemsSrc" st-table="data.benchItems.filteredBenchItems" class="table table-striped"> <thead> <tr class="table-header"> <th>#</th> <th st-sort="SetName">Комплекс услуг</th> <th st-sort="SubSetName">Услуга</th> <th st-sort="ContractId">Договор</th> <th st-sort="ContractorName">Подрядчик</th> <th st-sort="Ammount">Сумма, руб</th> <th></th> </tr> </thead> <tbody ng-repeat="benchItem in data.benchItems.filteredBenchItems"> <tr class="link-btn"> <td>{{$index+1}}</td> <td>{{benchItem.SetName || '-'}}</td> <td>{{benchItem.SubSetName || '-'}}</td> <td> <a href="" class="link-btn" ng-show="benchItem.LotusLink" ng-click="openLink(benchItem.LotusLink); $event.stopPropagation()">{{benchItem.ContractId || '-'}}</a> <span ng-hide="benchItem.LotusLink">{{benchItem.ContractId || '-'}}</span> </td> <td>{{benchItem.ContractorName || '-'}}</td> <td class="text-right">{{benchItem.Ammount | ruble}}</td> <td> <button ng-show="!benchItem.HasSapSmbRelation" class="btn btn-sm btn-outline-primary" ng-click="matchSapSmb(benchItem)" bs-tooltip="'Нет сопоставления подрядчика СМБ-SAP. Сопоставить вручную'" type="button"> <i class="fa fa-exclamation-triangle"></i> </button> </td> </tr> </tbody> </table> <div style="float:right"> <p><strong>Итого:</strong> {{data.benchItems.totalAmmount | ruble}}</p> </div> </div> <div class="no-content" ng-hide="data.benchItems.benchItemsSrc && data.benchItems.benchItemsSrc.length">Нет затрат</div> </uib-tab> <uib-tab heading="ПСД"> <div class="table-container" ng-show="data.psdDocs && data.psdDocs.length"> <table st-safe-src="data.psdDocsSrc" st-table="data.psdDocs" class="table table-striped"> <thead> <tr class="table-header"> <th></th> <th>#</th> <th st-sort="DocumentTypeName" st-sort-default="reverse">Тип проекта</th> <th st-sort="DocName">Наименование проекта</th> <th st-sort="ProjectNumber">Номер проекта</th> <th st-sort="DocDate">Дата разработки ПСД</th> <th st-sort="DocSize">Размер файла</th> <th st-sort="InspectionFileDate">Дата документа ГГЭ</th> <th>Документы</th> </tr> </thead> <tbody ng-repeat="document in data.psdDocs"> <tr class="link-btn" ng-click="openDocument(document)"> <td class="text-center" ng-click="$event.stopPropagation()"> <input type="checkbox" ng-checked="psdDocumentSelected(document)" ng-click="toggleSelectPsdDocument(document)"> </td> <td>{{$index+1}}</td> <td>{{document.DocumentTypeName || '-'}}</td> <td>{{document.DocName || '-'}}</td> <td>{{document.ProjectNumber || '-'}}</td> <td class="text-right">{{document.DocDate | date:'dd.MM.yyyy'}}</td> <td class="text-right">{{document.DocSize | bytes}}</td> <td class="text-right">{{document.InspectionFileDate | date:'dd.MM.yyyy'}}</td> <td class="text-center" ng-click="showFiles = !showFiles; $event.stopPropagation();"><i class="fa fa-folder-open"></i></td> </tr> <tr ng-if="showFiles"> <td colspan="11"> <psd-files guid="document.DocId"></psd-files> </td> </tr> </tbody> </table> <button type="button" class="btn btn-primary btn" style="margin-left: 20px; margin-bottom: 20px" ng-disabled="selectedPsdDocumentsIds.length === data.psdDocs.length" ng-click="selectAllPsd()"><span class="glyphicon glyphicon-check"></span> Выделить все</button> <button type="button" class="btn btn-primary btn" style="margin-left: 20px; margin-bottom: 20px" ng-disabled="!selectedPsdDocumentsIds.length" ng-click="unSelectAllPsd()"><span class="glyphicon glyphicon-unchecked"></span> Сбросить все</button> <button type="button" class="btn btn-primary btn" style="margin-left: 20px; margin-bottom: 20px" ng-disabled="!selectedPsdDocumentsIds || !selectedPsdDocumentsIds.length" ng-click="downloadSelectedPsdDocuments()"><span class="glyphicon glyphicon-save"></span> Скачать выбранные</button> </div> <div class="no-content" ng-hide="data.psdDocs && data.psdDocs.length">Нет документов</div> </uib-tab> <uib-tab heading="РД"> <div class="table-container" ng-show="data.rdDocs && data.rdDocs.length"> <table st-safe-src="data.rdDocsSrc" st-table="data.rdDocs" class="table table-striped"> <thead> <tr class="table-header"> <th></th> <th>#</th> <th st-sort="DocumentTypeName" st-sort-default="reverse">Тип разрешительной документации</th> <th st-sort="DocName">Название документа</th> <th st-sort="ProjectNumber">Номер проекта</th> <th st-sort="DocDate">Дата составления</th> <th st-sort="DocSize">Размер файла</th> </tr> </thead> <tbody> <tr class="link-btn" ng-click="openDocument(document)" ng-repeat="document in data.rdDocs"> <td class="text-center" ng-click="$event.stopPropagation()"> <input type="checkbox" ng-checked="rdDocumentSelected(document)" ng-click="toggleSelectRdDocument(document)"> </td> <td>{{$index+1}}</td> <td>{{document.DocumentTypeName || '-'}}</td> <td>{{document.DocName || '-'}}</td> <td>{{document.ProjectNumber || '-'}}</td> <td class="text-right">{{document.DocDate | date:'dd.MM.yyyy'}}</td> <td class="text-right">{{document.DocSize | bytes}}</td> </tr> </tbody> </table> <button type="button" class="btn btn-primary btn" style="margin-left: 20px; margin-bottom: 20px" ng-disabled="selectedRdDocumentsIds.length === data.rdDocs.length" ng-click="selectAllRd()"><span class="glyphicon glyphicon-check"></span> Выделить все</button> <button type="button" class="btn btn-primary btn" style="margin-left: 20px; margin-bottom: 20px" ng-disabled="!selectedRdDocumentsIds.length" ng-click="unSelectAllRd()"><span class="glyphicon glyphicon-unchecked"></span> Сбросить все</button> <button type="button" class="btn btn-primary btn" style="margin-left: 20px; margin-bottom: 20px" ng-disabled="!selectedRdDocumentsIds || !selectedRdDocumentsIds.length" ng-click="downloadSelectedRdDocuments()"><span class="glyphicon glyphicon-save"></span> Скачать выбранные</button> <!--<p ng-repeat="document in data.rdDocs" class="document-link"><a href="/crsreport/api/document/{{document.DocId}}/content" target="_blank">{{document.DocDate | date:'dd.MM.yyyy'}} <strong>{{document.DocName}}</strong> {{document.DocSize | bytes}}</a></p>--> </div> <div class="no-content" ng-hide="data.rdDocs && data.rdDocs.length">Нет документов</div> </uib-tab> <uib-tab heading="Глубина-День" select="filter.depthDaySelected=true" deselect="filter.depthDaySelected=false"> <!--<object data="data:application/x-silverlight-2," type="application/x-silverlight-2" width="100%" height="500px">--> <!--<%&#45;&#45;<param name="SplashScreenSource" value="ClientBin/splash.xaml" />&#45;&#45;%>--> <!--<param name="onSourceDownloadProgressChanged" value="DownloadProgress" />--> <!--<param name="onsourcedownloadcomplete" value="DownloadComplete"/>--> <!--<param name="source" value="ClientBin/WSReport.xap" />--> <!--<param name="onError" value="onSilverlightError" />--> <!--<param name="background" value="white" />--> <!--<param name="minRuntimeVersion" value="5.1" />--> <!--<param name="autoUpgrade" value="true" />--> <!--<param name="uiculture" value="ru-RU" />--> <!--<param name="culture" value="ru-RU" />--> <!--<param name="initParams" value="nohdr=true,pth_day_only=true,w={{data.well.UID}}" />--> <!--<a href="http://go.microsoft.com/fwlink/?LinkID=149156&v=4.0.50826.0" style="text-decoration: none">--> <!--<img src="http://go.microsoft.com/fwlink/?LinkId=161376" alt="Get Microsoft Silverlight"--> <!--style="border-style: none" />--> <!--</a>--> <!--</object>--> <iframe ng-src="{{data.iframeUrl}}" style="width: 100%; height: 500px" ng-if="filter.depthDaySelected && data.iframeUrl != null"></iframe> </uib-tab> <uib-tab heading="ЭДС"> <div ng-show="data.edsDocsSrc && data.edsDocsSrc.length" class="table-container"> <table st-safe-src="data.edsDocsSrc" st-table="data.edsDocs" class="table table-striped"> <thead> <tr class="table-header"> <th></th> <th>#</th> <th st-sort="DocName">Название документа</th> <th st-sort="DocType" st-sort-default="reverse">Тип документа</th> <th>Размер файла</th> </tr> </thead> <tbody> <tr class="link-btn" ng-click="openDocument(document)" ng-repeat="document in data.edsDocs"> <td class="text-center" ng-click="$event.stopPropagation()"> <input type="checkbox" ng-checked="edsDocumentSelected(document)" ng-click="toggleSelectEdsDocument(document)"> </td> <td>{{$index+1}}</td> <td>{{document.DocName}}</td> <td>{{document.DocType}}</td> <td class="text-right">{{document.DocSize | bytes}}</td> </tr> </tbody> </table> <button type="button" class="btn btn-primary btn" style="margin-left: 20px; margin-bottom: 20px" ng-disabled="selectedEdsDocumentsIds.length === data.edsDocs.length" ng-click="selectAllEds()"><span class="glyphicon glyphicon-check"></span> Выделить все</button> <button type="button" class="btn btn-primary btn" style="margin-left: 20px; margin-bottom: 20px" ng-disabled="!selectedEdsDocumentsIds.length" ng-click="unSelectAllEds()"><span class="glyphicon glyphicon-unchecked"></span> Сбросить все</button> <button type="button" class="btn btn-primary btn" style="margin-left: 20px; margin-bottom: 20px" ng-disabled="!selectedEdsDocumentsIds || !selectedEdsDocumentsIds.length" ng-click="downloadSelectedEdsDocuments()"><span class="glyphicon glyphicon-save"></span> Скачать выбранные</button> </div> <div class="no-content" ng-hide="data.edsDocsSrc && data.edsDocsSrc.length">Нет документов</div> </uib-tab> <uib-tab heading="Договоры"> <div class="table-container" ng-show="data.wellAgreements && data.wellAgreements.length"> <table st-safe-src="data.wellAgreementsSrc" st-table="data.wellAgreements" class="table table-striped"> <thead> <tr class="table-header"> <th>#</th> <th st-sort="AgreementId">Номер договора</th> <th st-sort="VendorName">Контрагент</th> <th st-sort="StartDate">Начало действия</th> <th st-sort="EndDate">Окончание действия</th> <th st-sort="AgreementSum">Сумма договора, руб</th> <th st-sort="Payed">Освоено, руб</th> </tr> </thead> <tbody ng-repeat="document in data.wellAgreements"> <tr class="link-btn" ng-click="showTransactions = !showTransactions;"> <td>{{$index+1}}</td> <td> <a href="" class="link-btn" ng-show="document.LotusLink" ng-click="openLink(document.LotusLink); $event.stopPropagation()">{{document.AgreementId || '-'}}</a> <span ng-hide="document.LotusLink">{{document.AgreementId || '-'}}</span> </td> <td>{{document.VendorName || '-'}}</td> <td class="text-right">{{document.StartDate | date:'dd.MM.yyyy'}}</td> <td class="text-right">{{document.EndDate | date:'dd.MM.yyyy'}}</td> <td class="text-right">{{document.AgreementSum | ruble}}</td> <td class="text-right">{{document.Payed | ruble}}</td> </tr> <tr ng-if="showTransactions"> <td colspan="8"> <table class="table table-striped"> <thead> <tr class="table-header"> <th>#</th> <th>Дата оказания услуг</th> <th>Дата начисления</th> <th>Дата поставки</th> <th>Дата документа</th> <th>Дата проводки </th> <th>Сумма, руб </th> </tr> </thead> <tbody> <tr ng-repeat="transaction in document.Transactions"> <td>{{$index + 1}}</td> <td class="text-right">{{transaction.ActDate | date:'dd.MM.yyyy'}}</td> <td class="text-right">{{transaction.ChargeDate | date:'dd.MM.yyyy'}}</td> <td class="text-right">{{transaction.DeliveryDate | date:'dd.MM.yyyy'}}</td> <td class="text-right">{{transaction.DocumentDate | date:'dd.MM.yyyy'}}</td> <td class="text-right">{{transaction.TransactionDate | date:'dd.MM.yyyy'}}</td> <td class="text-right">{{transaction.Amount | ruble}}</td> </tr> </tbody> </table> </td> </tr> </tbody> </table> </div> <div class="no-content" ng-hide="data.wellAgreements && data.wellAgreements.length">Нет документов</div> </uib-tab> <uib-tab heading="НПВ" select="filter.npvChartSelected=true; updateNpvChartData(500);" deselect="filter.npvChartSelected=false"> <div ng-if="data.npv && data.npv.length && filter.npvChartSelected"> <div class="npv-chart-wrapper"> <div class="npv-chart-info"> <button class="btn btn-sm chart-switch-btn" ng-click="filter.chartDrilldown = !filter.chartDrilldown"> <i class="fa fa-exchange"></i> </button> <div class="chart-total"> <p><strong>Всего НПВ, сут:</strong> {{data.npvDuration | number:2}}</p> <p><strong>Всего, %:</strong> {{data.npvPc | number:2}}</p> <p><strong>T общ, сут:</strong> {{data.npvDrillingDurationTotal | number:2}}</p> </div> <div class="chart-options" ng-hide="filter.chartDrilldown"> <div class="checkbox"> <label> <input type="checkbox" ng-model="filter.showNpvType"> Тип НПВ </label> </div> <div class="checkbox"> <label> <input type="checkbox" ng-model="filter.showNpvClass"> Класс НПВ </label> </div> <div class="checkbox"> <label> <input type="checkbox" ng-model="filter.showNpvReason"> Причина НПВ </label> </div> </div> </div> <highchart config="npvChartConfig" ng-if="npvChartConfig"></highchart> </div> <div class="npv-chart-wrapper"> <highchart config="npvCausersChartConfig" ng-if="npvCausersChartConfig"></highchart> </div> </div> <div class="no-content" ng-hide="data.npv && data.npv.length">Нет данных</div> </uib-tab> </uib-tabset> </div> </div> </div> </div> 