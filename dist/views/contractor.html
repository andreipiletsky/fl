<div class="contractor-container"> <div ng-hide="data.loaded" class="full-height text-primary"> <centered-fa-spinner></centered-fa-spinner> </div> <div ng-show="data.loaded" class="container-fluid smb-static-height pvchart-filters"> <div class="filters-container"> <table width="100%"> <tbody> <tr> <td> <smb-triple-data-switch ng-model="filter.drillType"></smb-triple-data-switch> </td> <td class="text-center"> <smb-triple-period-switch ng-model="filter.timeKey"></smb-triple-period-switch> <period-counter time-key="filter.timeKey" time-count="filter.timeCount"></period-counter> </td> <td class="text-right"> <smb-triple-type-switch ng-model="filter.wellState" style="visibility: hidden"></smb-triple-type-switch> <smb-double-view-switch show-excel="true" excel-handler="getExcel()"></smb-double-view-switch> </td> </tr> </tbody> </table> </div> <div class="sub-heading"> <a class="choice" data-animation="am-fade-and-slide-top" data-template="views/modals/companies.html" bs-modal="modal">{{getCompanyName(filter.companyUID)}}</a> <i class="fa fa-long-arrow-right"></i> <a class="choice" data-animation="am-fade-and-slide-top" data-template="views/modals/fields.html" bs-modal="modal">{{getFieldName(filter.fieldUID)}}</a> </div> </div> <div ng-show="data.contractorLoaded && data.error" class="container-fluid fields-chart-content-container error-container"> <p class="error-message">Не удалось получить данные.</p> </div> <div ng-hide="data.contractorLoaded" class="container-fluid fields-chart-content-container error-container"> <centered-fa-spinner></centered-fa-spinner> </div> <div ng-show="data.contractorLoaded && !data.error" class="container-fluid top-padded locality-filters"> <div class="sub-content-container"> <div class="row panel"> <div class="col-sm-12"> <h3 class="contractor-name text-center"> {{data.contractor.CompanyName}} <button type="button" class="btn btn-sm btn-default" ng-model="filter.lineId" placeholder="Тип сервиса" bs-options="line.id as line.name for line in data.lines" bs-select> <span class="caret"></span> </button> </h3> <h1 class="text-center" ng-hide="data.lineInfo">Нет данных</h1> <div class="col-sm-12" ng-show="data.lineInfo"> <p><strong>Дата начала работы:</strong> {{data.lineInfo.WorkBegin | date:'dd.MM.yyyy'}}</p> <!--<p><strong>Количество БУ:</strong> {{data.lineInfo.DrillRigCount}} шт</p>--> <p><strong>Кол-во пробуренных скважин:</strong> {{data.lineInfo.DrilledWellsCount}} шт</p> <p><strong>Кол-во действующих договоров:</strong> {{data.lineInfo.ActualAgreementCount}} шт</p> <p><strong>Кол-во освоенных кап.вложений:</strong> {{data.contractor.AmountTotal | ruble}}</p> </div> </div> </div> <div class="tab-container" ng-show="data.lineInfo"> <uib-tabset justified="true"> <uib-tab heading="Физика"> <div class="row physic-tab"> <div class="col-sm-12"> <div class="col-sm-3" ng-repeat="parameter in data.parameters"> <smb-widget ng-model="parameter" inverse="true"></smb-widget> </div> </div> </div> </uib-tab> <uib-tab heading="Экономика"> <div class="table-container" style="max-width: 100%" ng-show="data.finParametersSrc && data.finParametersSrc.length"> <table st-safe-src="data.finParametersSrc" st-table="data.finParameters" class="table table-striped"> <thead> <tr class="table-header"> <th st-sort="CategoryItemName">Категория затрат</th> <th st-sort="CostItemName">Статья затрат</th> <th st-sort="EcuBrdServiceName">ЕКУ БРД</th> <th st-sort="Ammount">Потрачено</th> </tr> </thead> <tbody ng-repeat="finParameter in data.finParameters"> <tr class="link-btn"> <td>{{finParameter.CategoryItemName || '-'}}</td> <td>{{finParameter.CostItemName || '-'}}</td> <td>{{finParameter.EcuBrdServiceName || '-'}}</td> <td class="text-right"> {{finParameter.Ammount | customCurrency: finParameter.ContractPaymentCurrency}} </td> </tr> </tbody> </table> </div> <div class="no-content" ng-hide="data.finParametersSrc && data.finParametersSrc.length">Нет данных</div> </uib-tab> <uib-tab heading="Затраты"> <div class="table-container" ng-show="data.benchSummary.benchSummarySrc && data.benchSummary.benchSummarySrc.length"> <table class="filters-table"> <tbody> <tr> <td class="text-right" style="width: 120px"> Комплекс услуг: </td> <td class="text-left" style="width: 130px"> <button type="button" class="btn btn-sm btn-default btn-select" ng-model="data.benchSummary.filters.setName" placeholder="Комплекс услуг" bs-options="set.id as set.name for set in data.benchSummary.sets" bs-select> <span class="caret"></span> </button> </td> <td class="text-right" style="width: 70px"> Услуга: </td> <td class="text-left" style="width: 130px"> <button type="button" class="btn btn-sm btn-default btn-select" ng-model="data.benchSummary.filters.subSetName" placeholder="Услуга" bs-options="subSet.id as subSet.name for subSet in data.benchSummary.subSets" bs-select> <span class="caret"></span> </button> </td> <td class="text-right" style="width: 90px"> Категория статьи затрат: </td> <td class="text-left" style="width: 130px"> <button type="button" class="btn btn-sm btn-default btn-select" ng-model="data.benchSummary.filters.costCategoryName" placeholder="Услуга" bs-options="costCategoryName.id as costCategoryName.name for costCategoryName in data.benchSummary.costCategoryNames" bs-select> <span class="caret"></span> </button> </td> <td class="text-right" style="width: 80px"> Статья затрат: </td> <td class="text-left" style="width: 130px"> <button type="button" class="btn btn-sm btn-default btn-select" ng-model="data.benchSummary.filters.costItemName" placeholder="Услуга" bs-options="costItemName.id as costItemName.name for costItemName in data.benchSummary.costItemNames" bs-select> <span class="caret"></span> </button> </td> <td class="text-right" style="width: 80px"> Структура работ: </td> <td class="text-left" style="width: 130px"> <button type="button" class="btn btn-sm btn-default btn-select" ng-model="data.benchSummary.filters.workBreakdownStructureName" placeholder="Услуга" bs-options="workBreakdownStructureName.id as workBreakdownStructureName.name for workBreakdownStructureName in data.benchSummary.workBreakdownStructureNames" bs-select> <span class="caret"></span> </button> </td> <td class="text-right" style="width: 80px"> Договор: </td> <td class="text-left" style="width: 130px"> <button type="button" class="btn btn-sm btn-default btn-select" ng-model="data.benchSummary.filters.contractId" placeholder="Договор" bs-options="contract.id as contract.name for contract in data.benchSummary.contracts" bs-select> <span class="caret"></span> </button> </td> </tr> </tbody> </table> <table st-safe-src="data.benchSummary.filteredBenchSummarySrc" st-table="data.benchSummary.filteredBenchSummary" class="table table-striped"> <thead> <tr class="table-header"> <th>#</th> <th st-sort="SetName">Комплекс услуг</th> <th st-sort="SubSetName">Услуга</th> <th st-sort="CostCategoryName">Категория статьи затрат</th> <th st-sort="CostItemName">Статья затрат</th> <th st-sort="WorkBreakdownStructureName">Структура работ</th> <th st-sort="ContractId">Договор</th> <th st-sort="ContractPriceVAT">Стоимость договора, с НДС</th> <th st-sort="Ammount">Потрачено</th> </tr> </thead> <tbody ng-repeat="benchItem in data.benchSummary.filteredBenchSummary"> <tr class="link-btn"> <td>{{$index+1}}</td> <td>{{benchItem.SetName || '-'}}</td> <td>{{benchItem.SubSetName || '-'}}</td> <td>{{benchItem.CostCategoryName || '-'}}</td> <td>{{benchItem.CostItemName || '-'}}</td> <td>{{benchItem.WorkBreakdownStructureName || '-'}}</td> <td> <a href="" class="link-btn" ng-show="benchItem.LotusLink" ng-click="openLink(benchItem.LotusLink); $event.stopPropagation()">{{benchItem.ContractId || '-'}}</a> <span ng-hide="benchItem.LotusLink">{{benchItem.ContractId || '-'}}</span> </td> <td>{{benchItem.ContractPriceCurrencyPairsVAT | priceCurrencyPairs}}</td> <td class="text-right"> {{benchItem.Ammount | customCurrency: benchItem.ContractPaymentCurrency}} </td> </tr> </tbody> </table> <div style="float:right"> <p><strong>Итого:</strong> {{data.benchSummary.totalAmmount | ruble}}</p> </div> </div> <div class="no-content" ng-hide="data.benchSummary.benchSummarySrc && data.benchSummary.benchSummarySrc.length">Нет затрат</div> </uib-tab> <uib-tab heading="Затраты по скважинам"> <div class="table-container" ng-show="data.benchWells.benchWellsSrc && data.benchWells.benchWellsSrc.length"> <table class="filters-table"> <tbody> <tr> <td class="text-right" style="width: 30px"> ДО: </td> <td class="text-left" style="width: 100px"> <button type="button" class="btn btn-sm btn-default btn-select" ng-model="data.benchWells.filters.dzoName" placeholder="ДО" bs-options="dzo.id as dzo.name for dzo in data.benchWells.dzos" bs-select> <span class="caret"></span> </button> </td> <td class="text-right" style="width: 115px"> Месторождение: </td> <td class="text-left" style="width: 100px"> <button type="button" class="btn btn-sm btn-default btn-select" ng-model="data.benchWells.filters.localityName" placeholder="Месторождение" bs-options="locality.id as locality.name for locality in data.benchWells.localities" bs-select> <span class="caret"></span> </button> </td> <td class="text-right" style="width: 40px"> Куст: </td> <td class="text-left" style="width: 60px"> <button type="button" class="btn btn-sm btn-default btn-select" ng-model="data.benchWells.filters.clusterName" placeholder="Куст" bs-options="cluster.id as cluster.name for cluster in data.benchWells.clusters" bs-select> <span class="caret"></span> </button> </td> <td class="text-right" style="width: 75px"> Скважина: </td> <td class="text-left" style="width: 60px"> <button type="button" class="btn btn-sm btn-default btn-select" ng-model="data.benchWells.filters.wellName" placeholder="Скважина" bs-options="well.id as well.name for well in data.benchWells.wells" bs-select> <span class="caret"></span> </button> </td> <td class="text-right" style="width: 103px"> Цель бурения: </td> <td class="text-left" style="width: 60px"> <button type="button" class="btn btn-sm btn-default btn-select" ng-model="data.benchWells.filters.drillTypeName" placeholder="Цель бурения" bs-options="drillType.id as drillType.name for drillType in data.benchWells.drillTypes" bs-select> <span class="caret"></span> </button> </td> <td class="text-right" style="width: 103px"> Тип скважины: </td> <td class="text-left" style="width: 60px"> <button type="button" class="btn btn-sm btn-default btn-select" ng-model="data.benchWells.filters.dn7TypeName" placeholder="Тип скважины" bs-options="dn7Type.id as dn7Type.name for dn7Type in data.benchWells.dn7Types" bs-select> <span class="caret"></span> </button> </td> <td class="text-right" style="width: 110px"> Комплекс услуг: </td> <td class="text-left" style="width: 70px"> <button type="button" class="btn btn-sm btn-default btn-select" ng-model="data.benchWells.filters.setName" placeholder="Комплекс услуг" bs-options="set.id as set.name for set in data.benchWells.sets" bs-select> <span class="caret"></span> </button> </td> <td class="text-right" style="width: 55px"> Услуга: </td> <td class="text-left" style="width: 70px"> <button type="button" class="btn btn-sm btn-default btn-select" ng-model="data.benchWells.filters.subSetName" placeholder="Услуга" bs-options="subSet.id as subSet.name for subSet in data.benchWells.subSets" bs-select> <span class="caret"></span> </button> </td> <td class="text-right" style="width: 65px"> Договор: </td> <td class="text-left" style="width: 100px"> <button type="button" class="btn btn-sm btn-default btn-select" ng-model="data.benchWells.filters.contractId" placeholder="Договор" bs-options="contract.id as contract.name for contract in data.benchWells.contracts" bs-select> <span class="caret"></span> </button> </td> </tr> </tbody> </table> <table st-safe-src="data.benchWells.filteredBenchWellsSrc" st-table="data.benchWells.filteredBenchWells" class="table table-striped"> <thead> <tr class="table-header"> <th>#</th> <th st-sort="DzoName">ДО</th> <th st-sort="LocalityName">Месторождение</th> <th st-sort="ClusterName">Куст</th> <th st-sort="WellName">Скважина</th> <th st-sort="DrillTypeName">Цель бурения</th> <th st-sort="Dn7TypeName">Тип скважины</th> <th st-sort="SetName">Комплекс услуг</th> <th st-sort="SubSetName">Услуга</th> <th st-sort="ContractId">Договор</th> <th st-sort="Ammount">Потрачено</th> </tr> </thead> <tbody ng-repeat="benchItem in data.benchWells.filteredBenchWells"> <tr class="link-btn"> <td>{{$index+1}}</td> <td>{{benchItem.DzoName || '-'}}</td> <td>{{benchItem.LocalityName || '-'}}</td> <td>{{benchItem.ClusterName || '-'}}</td> <td>{{benchItem.WellName || '-'}}</td> <td>{{benchItem.DrillTypeName || '-'}}</td> <td>{{benchItem.Dn7TypeName || '-'}}</td> <td>{{benchItem.SetName || '-'}}</td> <td>{{benchItem.SubSetName || '-'}}</td> <td> <a href="" class="link-btn" ng-show="benchItem.LotusLink" ng-click="openLink(benchItem.LotusLink); $event.stopPropagation()">{{benchItem.ContractId || '-'}}</a> <span ng-hide="benchItem.LotusLink">{{benchItem.ContractId || '-'}}</span> </td> <td class="text-right"> {{benchItem.Ammount | customCurrency: benchItem.ContractPaymentCurrency}} </td> </tr> </tbody> </table> </div> <div class="no-content" ng-hide="data.benchWells.benchWellsSrc && data.benchWells.benchWellsSrc.length">Нет затрат</div> </uib-tab> <uib-tab heading="Буровые установки" ng-if="data.lineInfo.LineId === 'a7588dfd-1e2e-4cb9-a60d-3a5b875bd216'"> <div class="table-container" style="max-width: 100%" ng-show="data.equipmentSrc && data.equipmentSrc.length"> <table st-safe-src="data.equipmentSrc" st-table="data.equipment" class="table table-striped"> <thead> <tr class="table-header"> <th st-sort="EquipmentName">Тип</th> <th st-sort="LocalityName">Месторождение</th> <th st-sort="Count">Количество</th> </tr> </thead> <tbody ng-repeat="equipment in data.equipment"> <tr class="link-btn"> <td>{{equipment.EquipmentName || '-'}}</td> <td>{{equipment.LocalityName || '-'}}</td> <td class="text-right">{{equipment.Count}}</td> </tr> </tbody> </table> </div> <div class="no-content" ng-hide="data.equipmentSrc && data.equipmentSrc.length">Нет данных</div> </uib-tab> <!--<uib-tab heading="Освоение КВ">--> <!--Не реализовано--> <!--</uib-tab>--> <uib-tab heading="Договоры"> <div class="table-container" style="max-width: 100%" ng-show="data.agreementsSrc && data.agreementsSrc.length"> <table st-safe-src="data.agreementsSrc" st-table="data.agreements" class="table table-striped"> <thead> <tr class="table-header"> <th>#</th> <th st-sort="DzoName">ДО</th> <th st-sort="AgreementId">Номер договора</th> <!--<th st-sort="VendorName">Контрагент</th>--> <th st-sort="StartDate">Начало действия</th> <th st-sort="EndDate">Окончание действия</th> <th st-sort="AgreementSum">Стоимость договора, с НДС</th> <th st-sort="Payed">Потрачено</th> </tr> </thead> <tbody ng-repeat="document in data.agreements"> <tr ng-click="showTransactions = !showTransactions;"> <td>{{$index+1}}</td> <td>{{document.DzoName}}</td> <td> <a href="" class="link-btn" ng-show="document.LotusLink" ng-click="openLink(document.LotusLink); $event.stopPropagation()">{{document.AgreementId || '-'}}</a> <span ng-hide="document.LotusLink">{{document.AgreementId || '-'}}</span> </td> <!--<td>{{document.VendorName || '-'}}</td>--> <td class="text-right">{{document.StartDate | date:'dd.MM.yyyy'}}</td> <td class="text-right">{{document.EndDate | date:'dd.MM.yyyy'}}</td> <td class="text-right">{{document.AgreementSum | priceCurrencyPairs}}</td> <td class="text-right">{{document.Payed | ruble}}</td> </tr> <!-- <tr ng-if="showTransactions">
                  <td colspan="7">
                    <table class="table table-striped">
                      <thead>
                      <tr class="table-header">
                        <th>#</th>
                        <th>Дата оказания услуг</th>
                        <th>Дата начисления</th>
                        <th>Дата поставки</th>
                        <th>Дата документа</th>
                        <th>Дата проводки </th>
                        <th>Сумма, руб </th>
                      </tr>
                      </thead>
                      <tbody>
                      <tr ng-repeat="transaction in document.Transactions">
                        <td>{{$index + 1}}</td>
                        <td class="text-right">{{transaction.ActDate | date:'dd.MM.yyyy'}}</td>
                        <td class="text-right">{{transaction.ChargeDate | date:'dd.MM.yyyy'}}</td>
                        <td class="text-right">{{transaction.DeliveryDate | date:'dd.MM.yyyy'}}</td>
                        <td class="text-right">{{transaction.DocumentDate | date:'dd.MM.yyyy'}}</td>
                        <td class="text-right">{{transaction.TransactionDate | date:'dd.MM.yyyy'}}</td>
                        <td class="text-right">{{transaction.Amount | ruble}}</td>
                      </tr>
                      </tbody>
                    </table>
                  </td>
                </tr> --> </tbody> </table> </div> <div class="no-content" ng-hide="data.agreementsSrc && data.agreementsSrc.length">Нет документов</div> </uib-tab> <uib-tab heading="НПВ" select="filter.npvChartSelected=true; updateNpvChartData(500);" deselect="filter.npvChartSelected=false"> <div ng-if="data.npv && data.npv.length && filter.npvChartSelected"> <div class="npv-chart-wrapper" style="width: 100%"> <div class="col-sm-2"> <div class="chart-total"> <p><strong>Всего НПВ, сут:</strong> {{data.npvDuration | round:1}}</p> <p><strong>Всего НПВ, %:</strong> {{data.npvPc | round:1}}</p> <button class="btn btn-sm chart-switch-btn" ng-click="filter.chartDrilldown = !filter.chartDrilldown"> <i class="fa fa-exchange"></i> </button> <div class="chart-options" ng-hide="filter.chartDrilldown"> <div class="checkbox"> <label> <input type="checkbox" ng-model="filter.showNpvType"> Тип НПВ </label> </div> <div class="checkbox"> <label> <input type="checkbox" ng-model="filter.showNpvClass"> Класс НПВ </label> </div> <div class="checkbox"> <label> <input type="checkbox" ng-model="filter.showNpvReason"> Причина НПВ </label> </div> </div> </div> </div> <div class="col-sm-8"> <highchart config="npvChartConfig" ng-if="npvChartConfig"></highchart> </div> <div class="col-sm-2"> </div> </div> </div> <div class="no-content" ng-hide="data.npv && data.npv.length">Нет данных</div> </uib-tab> </uib-tabset> </div> </div> </div> </div> 