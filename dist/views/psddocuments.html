<smb-documents-menu></smb-documents-menu> <div class="psd-documents-container"> <div ng-hide="data.loaded" class="full-height text-primary"> <centered-fa-spinner></centered-fa-spinner> </div> <div ng-show="data.loaded" class="container table-container container-very-wide"> <div class="view-mode-container"> <smb-double-view-switch ng-model="filter.viewMode" show-excel="true" excel-handler="getExcel()"></smb-double-view-switch> </div> <div class="box-list" st-pipe="updateTableData" st-table="data.items"> <legend> Проектно-сметная документация <div class="round-button-add ng-click-active" ng-click="addPsdDocument()" ng-show="user.CanEditPsd"><i class="fa fa-plus-circle"></i> <span>Добавить</span></div> </legend> <div class="table-filters"> <div class="row"> <div class="col-sm-2"> <label class="control-label col-sm-5"> По ДО </label> <div class="control-filter col-sm-7"> <button type="button" class="btn btn-sm btn-default btn-select" ng-model="filter.companyId" bs-options="company.UID as company.name for company in data.companiesFilter" bs-select st-filter="'branchId'"> <span class="caret"></span> </button> </div> </div> <div class="col-sm-2"> <label class="control-label col-sm-5"> По типу </label> <div class="control-filter col-sm-7"> <button type="button" class="btn btn-sm btn-default btn-select" ng-model="filter.documentType" bs-options="psdDocumentType.id as psdDocumentType.name for psdDocumentType in data.psdDocumentTypesFilter" bs-select st-filter="'documentType'"> <span class="caret"></span> </button> </div> </div> <div class="col-sm-3"> <label class="control-label col-sm-7"> Год разработки </label> <div class="control-filter col-sm-5"> <button type="button" class="btn btn-sm btn-default btn-select" ng-model="filter.psdDocumentYear" bs-options="year.id as year.name for year in data.psdDocumentYears" bs-select st-filter="'year'"> <span class="caret"></span> </button> </div> </div> </div> <div class="row"> <div class="col-sm-2"> <label class="control-label col-sm-5"> Поиск </label> <div class="control-filter col-sm-7"> <button type="button" class="btn btn-sm btn-default btn-select" ng-model="filter.searchCol" bs-options="col.id as col.name for col in searchCols | filter: {show: true}" bs-select> <span class="caret"></span> </button> </div> </div> <div class="col-sm-5 search-box"> <input st-search="{{getSearchList()}}" ng-model="filter.search" placeholder="Поиск" class="input-sm form-control" type="text"> </div> <div class="col-sm-2 col-sm-offset-3"> <button type="button" class="btn btn-sm btn-default btn-select" ng-model="filter.showedCols" placeholder="столбцы" data-multiple="1" max-length-html="выбрано" bs-options="col.id as col.name for col in tableCols" bs-select> <span class="caret"></span> </button> </div> </div> </div> <div class="table-scroll" sync-horizontal-scrolls="horizontal-scroll"> <div class="scroll-table-header horizontal-scroll"> <table class="table table-striped fixed"> <thead> <tr class="table-header text-center"> <th width="50">#</th> <th width="60" class="text-center" ng-show="showCol('files')">Д-ты</th> <th width="220" class="text-center" st-sort="branchName" ng-show="showCol('branchName')">ДО</th> <th width="170" class="text-center" st-sort="localityName" ng-show="showCol('localityName')">Месторождение</th> <th width="85" class="text-center" st-sort="profileType" ng-show="showCol('profileType')">Профиль</th> <th width="130" class="text-center" st-sort="documentType" ng-show="showCol('documentType')">Тип проекта</th> <th width="380" class="text-center" st-sort="documentName" st-sort-default="true" ng-show="showCol('documentName')">Наименование проекта</th> <th width="120" class="text-center" st-sort="projectNumber" ng-show="showCol('projectNumber')">Номер проекта</th> <th width="120" class="text-center" st-sort="drillTypeEnum" ng-show="showCol('drillTypeEnum')">Цель бурения</th> <th width="120" class="text-center" st-sort="categoryTypeEnum" ng-show="showCol('categoryTypeEnum')">Назначение скважины</th> <th width="170" class="text-center" st-sort="MeasuredDepthActual" ng-show="showCol('MeasuredDepthActual')">Глубина бурения по стволу</th> <th width="120" class="text-center" st-sort="VerticalDepthActual" ng-show="showCol('VerticalDepthActual')">Глубина по вертикали</th> <th width="120" class="text-center" st-sort="OffsetActual" ng-show="showCol('OffsetActual')">Отход по вертикали</th> <th width="120" class="text-center" st-sort="CasingDiameterActual" ng-show="showCol('CasingDiameterActual')">Диаметр ЭК</th> <th width="120" class="text-center" st-sort="CasingShoeDepthActual" ng-show="showCol('CasingShoeDepthActual')">Глубина спуска ЭК</th> <th width="120" class="text-center" st-sort="GeoHorizonNames" ng-show="showCol('GeoHorizonNames')">Целевой пласт</th> <th width="100" class="text-center" st-sort="inspectionFileDate" ng-show="showCol('inspectionFileDate')">Дата ГГЭ</th> <th width="80" class="text-center" ng-show="showCol('inspectionFile')">Скачать всё</th> <th width="120" class="text-center" st-sort="developmentDate" ng-show="showCol('developmentDate')">Дата разработки</th> <th width="100" class="text-center" st-sort="UploadDate" ng-show="showCol('UploadDate')">Дата загрузки</th> <th width="150" class="text-center" st-sort="UploaderUserName" ng-show="showCol('UploaderUserName')">Загрузил</th> <th width="80" class="text-center" ng-show="user.CanDeletePsd">Удалить</th> <th class="scroll-cell"><span></span></th> </tr> </thead> </table> </div> <div class="scroll-table-body horizontal-scroll"> <table ng-show="data.items.length && data.tableLoaded" class="table table-striped fixed"> <tbody ng-repeat="item in data.items"> <tr class="link-btn" ng-click="showPsdDocumentModal(item)"> <td width="50">{{data.itemsSkip + $index + 1}}</td> <td width="60" ng-show="showCol('files')" class="text-center" ng-click="showFiles = !showFiles; $event.stopPropagation();"><i class="fa fa-folder-open"></i></td> <td width="220" ng-show="showCol('branchName')">{{item.branchName}}</td> <td width="170" ng-show="showCol('localityName')">{{item.localityName}}</td> <td width="85" ng-show="showCol('profileType')">{{item.profileType}}</td> <td width="130" ng-show="showCol('documentType')">{{item.documentType}}</td> <td width="380" ng-show="showCol('documentName')">{{item.documentName}}</td> <td width="120" ng-show="showCol('projectNumber')">{{item.projectNumber}}</td> <td width="120" ng-show="showCol('drillTypeEnum')">{{item.DrillTypeEnum}}</td> <td width="120" ng-show="showCol('categoryTypeEnum')">{{item.CategoryTypeEnum}}</td> <td width="170" ng-show="showCol('MeasuredDepthActual')">{{item.MeasuredDepthActual}}</td> <td width="120" ng-show="showCol('VerticalDepthActual')">{{item.VerticalDepthActual}}</td> <td width="120" ng-show="showCol('OffsetActual')">{{item.OffsetActual}}</td> <td width="120" ng-show="showCol('CasingDiameterActual')">{{item.CasingDiameterActual}}</td> <td width="120" ng-show="showCol('CasingShoeDepthActual')">{{item.CasingShoeDepthActual}}</td> <td width="120" ng-show="showCol('GeoHorizonNames')">{{ item.GeoHorizonNames | join:', ' }}</td> <td width="100" ng-show="showCol('inspectionFileDate')" class="text-right">{{item.inspectionFileDate | date:'dd.MM.yyyy'}}</td> <td width="80" ng-show="showCol('inspectionFile')" class="text-center" ng-click="openDocument(item); $event.stopPropagation();"><i class="fa fa-download"></i></td> <td width="120" ng-show="showCol('developmentDate')" class="text-right">{{item.developmentDate | date:'dd.MM.yyyy'}}</td> <td width="100" ng-show="showCol('UploadDate')" class="text-right">{{item.UploadDate | date:'dd.MM.yyyy'}}</td> <td width="150" ng-show="showCol('UploaderUserName')">{{item.UploaderUserName || '-'}}</td> <td width="80" ng-show="user.CanDeletePsd" class="text-center text-danger" ng-click="deletePsdDocument(item); $event.stopPropagation();"><i class="fa fa-times"></i></td> </tr> <tr ng-if="showFiles"> <td colspan="14"> <psd-files guid="item.objUID"></psd-files> </td> </tr> </tbody> </table> <table class="table table-striped fixed" style="visibility: hidden; margin: 0;"> <tbody> <tr class="link-btn"> <td width="50"></td> <td width="60" ng-show="showCol('files')"></td> <td width="220" ng-show="showCol('branchName')"></td> <td width="170" ng-show="showCol('localityName')"></td> <td width="85" ng-show="showCol('profileType')"></td> <td width="130" ng-show="showCol('documentType')"></td> <td width="380" ng-show="showCol('documentName')"></td> <td width="120" ng-show="showCol('projectNumber')"></td> <td width="120" ng-show="showCol('drillTypeEnum')"></td> <td width="120" ng-show="showCol('categoryTypeEnum')"></td> <td width="170" ng-show="showCol('MeasuredDepthActual')"></td> <td width="120" ng-show="showCol('VerticalDepthActual')"></td> <td width="120" ng-show="showCol('OffsetActual')"></td> <td width="120" ng-show="showCol('CasingDiameterActual')"></td> <td width="120" ng-show="showCol('CasingShoeDepthActual')"></td> <td width="120" ng-show="showCol('GeoHorizonNames')"></td> <td width="100" ng-show="showCol('inspectionFileDate')"></td> <td width="80" ng-show="showCol('inspectionFile')"></td> <td width="120" ng-show="showCol('developmentDate')"></td> <td width="100" ng-show="showCol('UploadDate')"></td> <td width="150" ng-show="showCol('UploaderUserName')"></td> <td width="80" ng-show="user.CanDeletePsd"></td> </tr> </tbody> </table> </div> <div ng-hide="data.tableLoaded" class="table-message"> <p class="text-center">Загрузка...</p> </div> <div ng-show="data.error" class="table-message"> <p class="text-center text-danger">Не удалось получить данные.</p> </div> </div> <div class="table-pagination"> <table style="width: 100%;"> <tbody> <tr> <td width="33%"></td> <td width="33%" class="text-center"><div st-pagination="" st-template="views/pagination.html" st-items-by-page="filter.itemsPerPage" pages="data.pages"></div></td> <td width="33%" class="text-right"> Документов на странице: <input type="number" min="1" max="999" class="input-sm form-control" style="width: 80px; display: inline-block" ng-blur="filter.itemsPerPageSelect = filter.itemsPerPageSelect || 10" ng-model="filter.itemsPerPageSelect" ng-model-options="{ updateOn: 'default blur', debounce: { 'default': 500, 'blur': 0 } }" numbers-only> </td> </tr> </tbody> </table> </div> </div> </div> </div> 