<div class="production-plan-container"> <div ng-hide="data.loaded" class="full-height text-primary"> <centered-fa-spinner></centered-fa-spinner> </div> <div ng-show="data.loaded" class="plan-filters"> <div class="filters-container"> <table width="100%"> <tbody> <tr> <td class="text-right" style="width: 30px"> ДО: </td> <td class="text-left" style="width: 120px"> <button type="button" class="btn btn-sm btn-default btn-select" ng-model="filter.companyUID" placeholder="Компания" bs-options="company.UID as company.name for company in data.companies" bs-select> <span class="caret"></span> </button> </td> <td class="text-right" style="width: 35px"> Год: </td> <td class="text-left" style="width: 75px"> <button type="button" class="btn btn-sm btn-default btn-select" ng-model="filter.year" placeholder="Год" bs-options="year.id as year.name for year in data.years" bs-select> <span class="caret"></span> </button> </td> <td class="text-right" style="width: 102px"> Цель бурения: </td> <td class="text-left" style="width: 70px"> <button type="button" class="btn btn-sm btn-default btn-select" ng-model="filter.drillType" placeholder="Цель бурения" bs-options="drillType.id as drillType.name for drillType in data.drillTypes" bs-select> <span class="caret"></span> </button> </td> <td class="text-right" style="width: 75px"> Тип плана: </td> <td class="text-left" style="width: 80px"> <button type="button" class="btn btn-sm btn-default btn-select" ng-model="filter.planTypeName" placeholder="Тип плана" bs-options="planTypeName.id as planTypeName.name for planTypeName in data.planTypeNames" bs-select> <span class="caret"></span> </button> </td> <td class="text-right" style="width: 55px"> Статус: </td> <td class="text-left" style="width: 80px"> <button type="button" class="btn btn-sm btn-default btn-select" ng-model="filter.planStatusName" placeholder="Статус" bs-options="planStatusName.id as planStatusName.name for planStatusName in data.planStatusNames" bs-select> <span class="caret"></span> </button> </td> <td class="text-center" ng-show="filter.plansUIDs.length"> <smb-triple-period-switch hide-year="true" ng-model="filter.timeKey" ng-show="filter.plansUIDs.length > 0"></smb-triple-period-switch> <label class="period-label">{{getPeriodLabel()}}</label> </td> <td class="text-right"> <smb-double-view-switch style="float: right" ng-model="filter.tableMode" show-excel="data.selectedPlans.length > 0" excel-handler="getExcel()" show-table="data.selectedPlans.length > 0" show-chart="data.selectedPlans.length > 0" show-drill-project="true" drill-project-handler="openDrillProject()"></smb-double-view-switch> </td> </tr> </tbody> </table> </div> </div> <div ng-show="data.error" class="container-fluid plan-content-container error-container"> <p class="error-message">Не удалось получить данные.</p> </div> <div ng-hide="data.plansLoaded" class="container-fluid plan-content-container error-container"> <centered-fa-spinner></centered-fa-spinner> </div> <div ng-show="data.loaded" class="plans-table-container container table-container container-very-wide"> <div class="table-scroll" sync-horizontal-scrolls="horizontal-scroll" st-table="data.filteredPlans" st-safe-src="data.filteredPlansSrc"> <div class="scroll-table-header horizontal-scroll"> <table class="table table-striped fixed" style="width: 100%"> <thead> <tr class="table-header"> <th width="10%" class="text-center">К сравнению</th> <th width="25%" class="text-center" st-sort="getPlanCompanyName">ДО</th> <th width="5%" class="text-center" st-sort="PlanYear">Год</th> <th width="10%" class="text-center" st-sort="PlanDrillTypeName">Цель бурения</th> <th width="10%" class="text-center" st-sort="PlanTypeName">Тип</th> <th width="20%" class="text-center" st-sort="PlanName">Название</th> <th width="20%" class="text-center" st-sort="PlanStatusName">Статус</th> <th class="scroll-cell"><span></span></th> </tr> </thead> </table> </div> <div class="scroll-table-body horizontal-scroll"> <table class="table table-striped fixed" style="width: 100%"> <tbody ng-repeat="plan in data.filteredPlans"> <tr ng-click="selectPlan(plan.PlanId)"> <td width="10%" class="text-center"><input type="checkbox" ng-checked="planSelected(plan.PlanId)"></td> <td width="25%">{{getPlanCompanyName(plan.PlanDzoId)}}</td> <td width="5%" class="text-right">{{plan.PlanYear}}</td> <td width="10%">{{plan.PlanDrillTypeName}}</td> <td width="10%">{{plan.PlanTypeName}}</td> <td width="20%">{{plan.PlanName}}</td> <td width="20%" ng-click="$event.stopPropagation()"> <button type="button" class="btn btn-sm btn-default btn-select" ng-change="changePlanStatus(plan.PlanId, plan.PlanStatus)" ng-model="plan.PlanStatus" placeholder="{{getAvaliablePlanStatusName(plan.PlanStatus)}}" bs-options="avaliablePlanStatus.id as avaliablePlanStatus.name for avaliablePlanStatus in data.avaliablePlanStatuses" data-container="body" bs-select> <span class="caret"></span> </button> </td> </tr> </tbody> </table> </div> </div> </div> <div ng-show="data.selectedPlans.length" class="flipper-container plan-content-container container table-container container-very-wide"> <div class="flipper" ng-class="{flipped: !filter.tableMode}"> <div class="box-list front"> <legend ng-show="data.selectedPlans.length === 1"> График Бурения - {{data.selectedPlans[0].PlanName}} <button type="button" class="btn btn-sm btn-default btn-select" ng-model="filter.planYear" placeholder="Год" bs-options="year.id as year.name for year in data.planYears" bs-select> <span class="caret"></span> </button> </legend> <legend ng-show="data.selectedPlans.length > 1">Сравнение Графиков Бурения </legend> <div class="table-scroll" sync-horizontal-scrolls="horizontal-scroll" sync-vertical-scrolls="vertical-scroll"> <div class="scroll-table-header horizontal-scroll"> <table class="table table-striped fixed"> <thead> <tr class="table-header"> <th width="170" colspan="1" rowspan="2" class="cell-header">Показатель</th> <th width="60" rowspan="2"></th> <th width="{{120*data.selectedPlans.length}}" class="time-header" ng-repeat="timeHeader in data.tableData.timeHeaders" colspan="{{data.selectedPlans.length}}">{{timeHeader}}</th> <th width="{{120*data.selectedPlans.length}}" class="time-header" colspan="{{data.selectedPlans.length}}">Итого</th> <th class="scroll-cell" rowspan="2"><span></span></th> </tr> <tr class="table-header versions"> <th width="100" class="text-center" ng-repeat="header in data.tableData.headers track by $index">{{header}}</th> </tr> </thead> </table> </div> <div class="scroll-table-body horizontal-scroll vertical-scroll"> <table class="table table-striped fixed"> <tbody ng-repeat="param in data.tableData.params"> <tr> <td width="170" rowspan="2" class="cell-header">{{param.displayName}}, {{param.uom}}</td> <td width="60" class="cell-sub-header">ГС</td> <td ng-if="!planParameters.growingData" width="120" class="text-center" ng-repeat="d in data.tableData.data[param.displayName].gs track by $index">{{d}}</td> <td ng-if="planParameters.growingData" width="120" class="text-center" ng-repeat="d in data.tableData.data[param.displayName].aggr_gs track by $index">{{d}}</td> </tr> <tr> <td width="60" class="cell-sub-header">ННС</td> <td ng-if="!planParameters.growingData" width="120" class="text-center" ng-repeat="d in data.tableData.data[param.displayName].nns track by $index">{{d}}</td> <td ng-if="planParameters.growingData" width="120" class="text-center" ng-repeat="d in data.tableData.data[param.displayName].aggr_nns track by $index">{{d}}</td> </tr> </tbody> </table> </div> <div class="first-column"> <div class="scroll-table-header"> <table class="table table-striped fixed"> <thead> <tr class="table-header"> <th width="170" colspan="1" rowspan="2" class="cell-header">Показатель</th> <th width="60" rowspan="2">Тип</th> </tr> </thead> </table> </div> <div class="scroll-table-body vertical-scroll"> <table class="table table-striped fixed"> <tbody ng-repeat="param in data.tableData.params"> <tr> <td width="170" rowspan="2" class="cell-header">{{param.displayName}}, {{param.uom}}</td> <td width="60" class="cell-sub-header">ГС</td> </tr> <tr> <td width="60" class="cell-sub-header">ННС</td> </tr> </tbody> </table> </div> </div> </div> <div class="charts-settings" style="bottom: 0px;"> <div class="checkbox setting"> <label> <input type="checkbox" ng-model="planParameters.growingData"> Нарастающим итогом </label> </div> </div> </div> <div class="box-list back"> <legend ng-show="data.selectedPlans.length === 1"> Графики <button type="button" class="btn btn-sm btn-default btn-select" ng-model="filter.planYear" placeholder="Год" bs-options="year.id as year.name for year in data.planYears" bs-select> <span class="caret"></span> </button> </legend> <legend ng-show="data.selectedPlans.length > 1"> Графики </legend> <div class="charts-container" ng-if="!filter.tableMode"> <div class="container-fluid full-height"> <a class="col-sm-12 dash-item" ng-repeat="param in data.chartsData.params"> <h4 class="dash-item-header">{{param.displayName}}<br><span class="dimension">{{param.uom}}</span></h4> <div class="dash-item-chart" ng-if="!planParameters.growingChartsData"> <grouped-bar-chart ng-model="data.chartsData.data[param.displayName].normal" show-values="filter.showValues" class="full-height" tip-class="grouped-chart-tip" title-tip-class="grouped-chart-tip-title" tip-height="35" bar-colors="plansChartsColors" axis-offset-x="50" axis-offset-y="50" redraw-param="filter.tableMode"></grouped-bar-chart> </div> <div class="dash-item-chart" ng-if="planParameters.growingChartsData"> <grouped-bar-chart ng-model="data.chartsData.data[param.displayName].growing" show-values="filter.showValues" class="full-height" tip-class="grouped-chart-tip" title-tip-class="grouped-chart-tip-title" tip-height="35" bar-colors="plansChartsColors" axis-offset-x="50" axis-offset-y="50" redraw-param="filter.tableMode"></grouped-bar-chart> </div> </a> </div> </div> <!--         <div class="charts-settings">
          <div class="checkbox setting">
            <label>
              <input type="checkbox" ng-model="planParameters.growingChartsData"> Нарастающим итогом
            </label>
          </div>
        </div> --> <div class="legend"> <div class="plan-legend"> <span class="legend-color nns-legend-color"></span> <span class="legend-label">- ННС</span> </div> <div class="fact-legend"> <span class="legend-color gs-legend-color"></span> <span class="legend-label">- ГС</span> </div> <div class="select-values"> <label class="checkbox-inline"> <input type="checkbox" ng-model="filter.showValues"> Показывать значения </label> </div> <div class="select-values"> <label class="checkbox-inline"> <input type="checkbox" ng-model="planParameters.growingChartsData"> Нарастающим итогом </label> </div> </div> </div> </div> </div> </div> 